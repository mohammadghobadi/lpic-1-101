---
layout: article
chapter: دستورات گنو و یونیکس
order: 7.1
title: کار با خط فرمان
---

##پوسته ی خط فرمان

پوسته ی خط فرمان یاshell یک برنامه ساده بین کاربر و سیستم عامل است که محیطی را فراهم می‌کند تا کاربر با زدن دستورات بتواند با کرنل ارتباط برقرار کند.

پوسته معولا جز سیستم عامل محسوب نمی‌شود ولی کانال ارتباطی کاربر و سیستم عامل است.

پوسته به دو صورت خط فرمانCLI و گرافیکی GUI وجود دارد. معروف ترین پوسته های خط فرمان عبارتند از:

پوسته Bourne-Again shell یاbash

پوسته Korn shellیا ksh

پوسته C shellیاcsh

پوسته Z shell یا zsh

پوسته bash در سال 1987 توسط Brian Fox نگارش شد و از سال 1990 توسط Chet Ramey مدیریت می شود.نگارنده bash سعی کرده ویژگی های برتر پوسته های Born,C,Korn را در این پوسته بوجود آورد.

پوسته bash متداولترین پوسته در سیستم عامل لینوکس و همچنین Mac OSXاست.

هر کدام از این خطوط فرمان امکانات خاصی را برای کاربر فراهم می‌کنند که البته bash اکثراً پیش‌فرض است.

پوسته خط فرمان شامل ویژگی‌های شاخص زیر است:

خط فرمان به حروف کوچک و بزرگ حساس است.(casesensitive)

نام هر فایل بیش از 255 کاراکتر نمی‌تواند باشد.

در صورتی که اسم فایلی با . شروع شود؛مخفی می‌شود 
.
جدول زیر اسمی کاراکتر هایی که نباید در نام گذاری فایل‌ها  از آن‌ها استفاده کرد را نشان می‌دهد .

<table align="center" border="1" style="text-align:center">
<tr> <td> کاراکتر</td> <td> پیشنهاد </td> </tr>
<tr> <td> / </td> <td> ممنوع </td> </tr>
<tr> <td> \ </td> <td> بهتر است استفاده نشود یا (scape) شود. </td> </tr>
<tr> <td> - </td> <td> در اول اسم فایل و پس از فاصله استفاده نشود. </td> </tr>
<tr> <td> [] {} </td> <td> بهتر است استفاده نشود یا(scape) شود. </td> </tr>
<tr> <td> ? *</td> <td> بهتر است استفاده نشود یا (scape) شود. </td> </tr>
<tr> <td>' " </td> <td> بهتر است استفاده نشود یا (scape) شود. </td> </tr>
</table>





##انواع دستورات در خط فرمان

دستورات در خط فرمان به سه دسته تقسیم می‌شوند که براساس ترتیب اجرا به صورت زیر هستند:

alias :دستورات مجازی هستند که با تعریف آن‌ها دستورات واقعی اجرا می‌شوند. در‌واقع شبیه shortcut  عمل می‌کنند .(نرم افزاری برای اجرای آن‌ها نیست .)

دستورات داخلی یا Builtin command : دستوراتی هستند که در داخل محیط bash قرار دارند و خود bashآن‌ها را اجرا می‌کند .(شامل نرم‌افزار خارجی نیستند .)

دستورات خارجی یا External command : دستورات خارج از  bas}که با فراخوانی نرم افزارهای خارجی اجرا می‌شوند.

برای فهمیدن نوع هریک از دستورات ؛ از دستور زیر استفاده می‌شود .

<pre>
  Type command
</pre>

مثال:

<pre>
  $ type ls
</pre>

در صورتی که خروجی این دستور به صورت مسیر باشد دستور از نوعlexternal است و جز bashنیست.

برای دسترسی به راهنمای دستورات Builtin ؛ از دستور helpاستفاده می‌شود .
<pre>
  Help command
</pre>
وبرای دسترسی به راهنمای دستوراتexternal ؛ از دستور man استفاده می‌شود.
<pre>
  Man command
</pre>

###دستور man 


نحوه ی استفاده از این دستور به صورت زیر است:

<pre>
  man [options] [section] name
</pre>

گزینه های options این دستور شامل موارد زیر است :

<span dir="ltr">-a</span> : با این گزینه در صورتی که دستور در چندین section راهنما  داشته باشد پس از خروج از هریک؛ راهنمای بعدی باز می‌شود.

<span dir="ltr">-k</span>: با این گزینه یک کلمه را در راهنما جست‌و‌جو می‌کند.

<span dir="ltr">-w</span>: با این گزینه مسیر راهنما مشخص می‌شود.
بخش‌های sections این دستور شامل نه بخش مختلف است که البته یک دستور ممکن است در چند بخش دارای راهنما باشد.


<table align="center" border="1" style="text-align:center">
<tr> <td> بخش</td> <td> توضیحات</td> </tr>
<tr> <td> ۱ </td> <td> برنامه‌های اجرا شونده یا shell commands </td> </tr>
<tr> <td> ۲ </td> <td> دستوراتی که توسط سیستم فراخوانی می شوند </td> </tr>
<tr> <td> ۳ </td> <td> دستوراتی که در خلال اجرای کتابخانه‌ها اجرا می‌شوند </td> </tr>
<tr> <td> ۴ </td> <td> فایل‌های خاصی که معمولاً در مسیر dev قرار دارند </td> </tr>
<tr> <td> ۵ </td> <td> ساختار فایل‌ها مانند: eg /etc/passwd </td> </tr>
<tr> <td> ۶ </td> <td> بازی‌ها </td> </tr>
<tr> <td> ۷ </td> <td> دستورات مختلفی شامل ساختار بسته ها </td> </tr>
<tr> <td> ۸ </td> <td> دستورات مخصوص کاربر ریشه </td> </tr>
<tr> <td> ۹ </td> <td> دستورات معمولی کرنل</td> </tr>
</table>


<pre>
  $ man -wa ip
  /usr/share/man/man8/ip.8.gz
  /usr/share/man/man7/ip.7.gz
</pre>

حال برای فراخوانی تنها یک بخش خاص به صورت زیر عمل می‌شود:


 <pre>
  $ man 8 ip
</pre>

تعیین اولویت های دستور man از طریق یک متغیر به نام MANSECT انجام می‌شود که ترتریب اولویت ها با : از هم جدا می‌شوند.

مقدار پیش‌فرض این متغیر به صورت زیر است:


<pre>
  $ echo $MANSECT
  1:8:2:3:4:5:6:7:9:tcl:n:l:p:o
</pre>


مثالی برای جست وجو در یک موضوع خاص با استفاده از این دستور:


<pre>
  $ man -k player
  smplayer(1)		-The best GUI fronted for mplayer 
  ffplay(1)		-FFplay media player
  gmplayer(1)		-movie player
  gnash(1)		-GNU Flash (SWF) Player
  gtk-gnash(1)		-GNU Flash (SWF) Player
  totem(1)		-GNOME desktop movie player based on GStreamer
  vlc(1)			-The VLC media player
</pre>

دستور info نیز برای دستورات خارجی استفاده می‌شود که تفاوت آن با دستور man این است که چون دستور info  ساختاری صفحه به صفحه دارد دستورات طولانی در info قرار دارند.


###کار بر روی خط فرمان

پوسته خط فرمان یک محیط تعاملی است به این معنا که قابلیت برنامه نویسی و خودکارسازی را برای کاربر فراهم می کند.



###متغیرها
به مثال زیر توجه کنید:

<pre>
  $ lpi=test
</pre>

 مقدار متغیر lpi را برابر با test قرار می‌دهد.

 برای دیدن محتوای هر متغیر میتوان از دستور echo استفاده کرد:

<pre>
  $ echo $lpi
</pre>

که علامت $ در ابتدای نام متغیر؛معرف محتویات آن متغیر است.



###متغیرهای محیطی (Enviroment variable)



متغیر PATH : مسیر دستورات خارجی را مشخص می‌کند.

<pre>
  $ echo $PATH
  /sbin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</pre>



در صورتی که بخواهیم به مسیرهای بالا مسیری اضافه کنیم؛به صورت زیر عمل می‌کنیم:


<pre>
  $ echo $PATH:/home/user/bin
</pre>

به یاد داشته باشید مسیر فایل‌های اجرایی شامل چهار مورد زیر است:


<pre>
  /bin 
  /sbin 
  /usr/bin
  /usr/sbin
</pre>


متغیر PS1 :شکل prompt خط فرمان را مشخص می‌کند.

<pre>
  $ echo $PS1
  \u@\h:\w\$
</pre>

که کارکتر u \ به معنی نمایش نام کاربر؛h \ به معنی نام کامپیوتر؛ w \ نمایش شاخه جاری و $ \ زمانی که کاربر ریشه (root) باشد علامت# و در غیر این صورت علامت $ را نمایش می‌دهد.


در جدول زیر لیست چند کارکتر ویژه که همراه با این متغیر استفاده می‌شوند نمایش داده شده است :


<table align="center" border="1" style="text-align:center">
<tr> <td> کاراکتر ویژه</td> <td> توضیحات</td> </tr>
<tr> <td>  w \ </td> <td> مسیر شاخه جاری </td> </tr>
<tr> <td>W \</td> <td> نام شاخه جاری </td> </tr>
<tr> <td> $ \ </td> <td> کاربر ریشه را با # و مابقی را با $ نشان می‌دهد </td> </tr>
<tr> <td> ! \ </td> <td> شماره دستور در این پوشه را نشان می‌دهد  </td> </tr>
<tr> <td> t \ </td> <td> زمان را با فرمتHH:MM:SS در 24 ساعت نشان می‌دهد </td> </tr>
<tr> <td> T \</td> <td> زمان را با فرمتHH:MM:SS در12 ساعت نشان می‌دهد</td> </tr>
<tr> <td> n \ </td> <td> خط بعدی</td> </tr>
<tr> <td>d \</td> <td> نمایش تاریخ </td> </tr>
</table>




متغیر PS2 : مربوط به زمانی است که bash ورودی ها را در چند خط دریافت کند.


برای در دسترس بودن یک متغیر از دستور export استفاده می‌شود.


<pre>
  Export variabale
</pre>

پس از اجرای این دستور ؛ این متغیر یک متغییر محیطی است و در برنامه‌های اجرا شده وsubshell ها نیز قابل دسترسی می‌باشد .


####دستور set و unset 

با زدن دستور set در خط فرمان ؛لیست تمامی متغیر های محیطی قابل رویت می‌باشد. همچنین از دستور unset برای پاک کردن متغیر ها استفاده می‌شود. 


###ساختار دستورات در لینوکس

هر دستور در لینوکس شامل چهاربخش زیر است:

خود دستور(داخلی یا خارجی) 

گزینه های (option) آن دستور که معمولاً با - یا-- شروع می‌شوند.(البته می‌تواند بدون آن‌ها نیز باشد.)

ورودی های (argument) دستور

کلید Enter

برای اجرای پشت سر هم چند دستور از علامت “;” و برای اجرای یک دستور در چندین خط از علامت “< “ استفاده می‌شود.


<pre>
  $ ls ; ps	
  $ echo “This is test for multiple-line
  > command interactively
  >”
  This is test for multiple-line
  command interactively
</pre>




###تاریخچه دستورات

تاریخچه با دستور history قابل رویت است.که در‌واقع در فایل ~/.bash_history نگهداری می‌شود. 

تعداد آن  در یک متغیر محیطی به نام HISTSIZE تعیین می‌شود. که با گزینه -c کاملاً پاک می‌شود.

در جدول زیر چند نمونه از کاراکترهای این دستور آورده شده اند:



<table align="center" border="1" style="text-align:center">
<tr> <td> دستور</td> <td> توضیحات</td> </tr>
<tr> <td>  !! </td> <td> تکرار آخرین دستور </td> </tr>
<tr> <td> n! </td> <td> دستور شماره n در history را اجرا می‌کند  </td> </tr>
<tr> <td> !-n </td> <td> شماره دستور جاری منهای n  را اجرا می‌کند </td> </tr>
<tr> <td> String! </td> <td> آخرین دستوری که با string شروع می‌شود   </td> </tr>
<tr> <td>String?!</td> <td> آخرین دستوری که \lr{string} در آن استفاده شده است</td> </tr>
<tr> <td> string1^string2 </td> <td> در آخرین دستور string1 را با string2 جایگزین می‌کند .</td> </tr>
<tr> <td> Arrow key</td> <td> حرکت بین دستورات</td> </tr>
<tr> <td>ctrl+r</td> <td> جست‌و‌جو در history</td> </tr>
<tr> <td>ctrl+s</td> <td> جست‌و‌جو از اول به آخر history (زمانی جواب می‌دهد که stty -ixon  اجرا شده باشد)جست‌و‌جو در history</td> </tr>
</table>









                                                         



###دستورات مورد استفاده در خط فرمان

<table align="center" border="1" style="text-align:center">
<tr> <td> دستور</td> <td> توضیحات</td> </tr>
<tr> <td>  ctrl+l</td> <td> پاک کردن صفحه </td> </tr>
<tr> <td>ctrl+k</td> <td> cut کردن از محل مکان نما تا آخر خط  </td> </tr>
<tr> <td>Ctrl+ u </td> <td> cut کردن از محل مکان نما تا ابتدای خط </td> </tr>
<tr> <td> ctrl+y </td> <td>چسباندن یا همان paste </td> </tr>
<tr> <td>_ +ctrl</td> <td> undo</td> </tr>
<tr> <td> ctrl+e </td> <td> رفتن به انتهای دستور</td> </tr>
<tr> <td>  ctrl+a</td> <td> رفتن به ابتدای دستور</td> </tr>
<tr> <td>ctrl+d</td> <td> cut کردن کلمه به سمت انتهای خط </td> </tr>
<tr> <td>ctrl+w</td> <td> cut کردن کلمه به سمت ‌ابتدای خط </td> </tr>
<tr> <td>ctrl+t</td> <td> جا به جایی کاراکتر زیر مکان نما با کاراکتر قبلی </td> </tr>
</table>




                                                              








